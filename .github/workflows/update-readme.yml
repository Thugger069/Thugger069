name: ðŸ”„ Auto-Update README V7.1

on:
  schedule:
    - cron: '0 * * * *'  # every hour
  workflow_dispatch:

jobs:
  update-readme:
    runs-on: ubuntu-latest
    concurrency:
      group: update-readme
      cancel-in-progress: true

    env:
      GITHUB_USERNAME: Thugger069
      AUTHOR_NAME: É¬É§É› É Ä±É¬ÆˆÉ§

    steps:
      # â”€â”€â”€â”€â”€ Checkout Repo â”€â”€â”€â”€â”€
      - name: Checkout repository
        uses: actions/checkout@v3

      # â”€â”€â”€â”€â”€ Setup Node.js 20 & pnpm â”€â”€â”€â”€â”€
      - name: Setup Node.js 20
        uses: actions/setup-node@v3
        with:
          node-version: 20
          cache: pnpm

      - name: Ensure pnpm is installed
        run: npm install -g pnpm

      # â”€â”€â”€â”€â”€ Install Dependencies â”€â”€â”€â”€â”€
      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      # â”€â”€â”€â”€â”€ Generate Cyberpunk Header â”€â”€â”€â”€â”€
      - name: Generate README Header
        run: |
          chmod +x scripts/generate-header.js
          node scripts/generate-header.js

      # â”€â”€â”€â”€â”€ Generate Terminal SVG if exists â”€â”€â”€â”€â”€
      - name: Generate Terminal SVG
        run: |
          if [ -f scripts/generate-terminal-svg.js ]; then
            chmod +x scripts/generate-terminal-svg.js
            node scripts/generate-terminal-svg.js
          else
            echo "scripts/generate-terminal-svg.js not found, skipping..."
          fi

      # â”€â”€â”€â”€â”€ Generate GitHub Stats â”€â”€â”€â”€â”€
      - name: Fetch GitHub Stats
        run: |
          curl -s "https://github-readme-stats.vercel.app/api?username=${GITHUB_USERNAME}&show_icons=true&theme=dark&hide_title=false&hide_border=true" -o assets/github-stats.svg

      # â”€â”€â”€â”€â”€ Append Snake Animation â”€â”€â”€â”€â”€
      - name: Fetch Snake Animation
        run: |
          curl -s "https://raw.githubusercontent.com/Thugger069/snake-animation/main/snake.svg" -o assets/snake.svg

      # â”€â”€â”€â”€â”€ Add Footer â”€â”€â”€â”€â”€
      - name: Generate Footer
        run: |
          FOOTER="<div style='text-align:center;font-family:Ubuntu Mono;color:#00F3FF;font-size:0.7rem;margin-top:1rem;'>Maintained by ${AUTHOR_NAME} | Â© $(date +%Y)</div>"
          echo "$FOOTER" > assets/footer.html

      # â”€â”€â”€â”€â”€ Commit & Push Changes â”€â”€â”€â”€â”€
      - name: Commit README Updates
        run: |
          git config user.name "GitHub Actions"
          git config user.email "actions@github.com"
          git add README.md assets/github-stats.svg assets/snake.svg assets/footer.html
          if git diff --cached --quiet; then
            echo "No changes detected, skipping commit."
          else
            git commit -m "âœ¨ Auto-update README V7.1 [ci skip]"
            git push origin HEAD:${{ github.ref_name }}
